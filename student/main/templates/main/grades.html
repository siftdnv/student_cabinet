{% extends 'main/cabinet_base.html' %}
{% load static %}

{% block title %}Успеваемость{% endblock %}

{% block content %}
<div class="page-header">
    <h1><i class="fas fa-chart-bar"></i> Моя успеваемость</h1>
    <p class="text-muted">Общий средний балл: <strong>4.7</strong></p>
</div>

<div class="grades-overview">
    <div class="overview-card">
        <div class="overview-icon" style="background: #4361ee;">
            <i class="fas fa-graduation-cap"></i>
        </div>
        <div class="overview-content">
            <h3>4.7</h3>
            <p>Средний балл</p>
        </div>
    </div>
    <div class="overview-card">
        <div class="overview-icon" style="background: #4cc9f0;">
            <i class="fas fa-check-circle"></i>
        </div>
        <div class="overview-content">
            <h3>18</h3>
            <p>Сдано работ</p>
        </div>
    </div>
    <div class="overview-card">
        <div class="overview-icon" style="background: #f72585;">
            <i class="fas fa-clock"></i>
        </div>
        <div class="overview-content">
            <h3>3</h3>
            <p>В процессе</p>
        </div>
    </div>
    <div class="overview-card">
        <div class="overview-icon" style="background: #ffd166;">
            <i class="fas fa-trophy"></i>
        </div>
        <div class="overview-content">
            <h3>7</h3>
            <p>Отличных оценок</p>
        </div>
    </div>
</div>

<div class="grades-content">
    <div class="grades-section">
        <h3><i class="fas fa-list"></i> Оценки по предметам</h3>
        <div class="subject-grades">
            <!-- Веб-программирование -->
            <div class="subject-card">
                <div class="subject-header">
                    <h4>Веб-программирование</h4>
                    <span class="subject-avg">4.8</span>
                </div>
                <div class="grades-list">
                    <div class="grade-item">
                        <span class="grade-work">Лабораторная работа #1</span>
                        <span class="grade-value excellent">5</span>
                        <span class="grade-date">15.10.2024</span>
                    </div>
                    <div class="grade-item">
                        <span class="grade-work">Лабораторная работа #2</span>
                        <span class="grade-value excellent">5</span>
                        <span class="grade-date">22.10.2024</span>
                    </div>
                    <div class="grade-item">
                        <span class="grade-work">Практическая работа</span>
                        <span class="grade-value good">4</span>
                        <span class="grade-date">05.11.2024</span>
                    </div>
                    <div class="grade-item">
                        <span class="grade-work">Курсовой проект</span>
                        <span class="grade-value pending">-</span>
                        <span class="grade-date">20.12.2024</span>
                    </div>
                </div>
            </div>

            <!-- Базы данных -->
            <div class="subject-card">
                <div class="subject-header">
                    <h4>Базы данных</h4>
                    <span class="subject-avg">4.5</span>
                </div>
                <div class="grades-list">
                    <div class="grade-item">
                        <span class="grade-work">SQL запросы</span>
                        <span class="grade-value excellent">5</span>
                        <span class="grade-date">10.10.2024</span>
                    </div>
                    <div class="grade-item">
                        <span class="grade-work">Нормализация БД</span>
                        <span class="grade-value good">4</span>
                        <span class="grade-date">25.10.2024</span>
                    </div>
                    <div class="grade-item">
                        <span class="grade-work">Проектирование</span>
                        <span class="grade-value excellent">5</span>
                        <span class="grade-date">08.11.2024</span>
                    </div>
                </div>
            </div>

            <!-- Python разработка -->
            <div class="subject-card">
                <div class="subject-header">
                    <h4>Python разработка</h4>
                    <span class="subject-avg">4.9</span>
                </div>
                <div class="grades-list">
                    <div class="grade-item">
                        <span class="grade-work">Основы Python</span>
                        <span class="grade-value excellent">5</span>
                        <span class="grade-date">12.10.2024</span>
                    </div>
                    <div class="grade-item">
                        <span class="grade-work">ООП в Python</span>
                        <span class="grade-value excellent">5</span>
                        <span class="grade-date">28.10.2024</span>
                    </div>
                    <div class="grade-item">
                        <span class="grade-work">Django框架</span>
                        <span class="grade-value excellent">5</span>
                        <span class="grade-date">15.11.2024</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="stats-section">
        <!-- Распределение оценок -->
        <div class="stats-card">
            <h3><i class="fas fa-chart-pie"></i> Распределение оценок</h3>
            <div class="chart-container">
                <div class="chart-item">
                    <div class="chart-bar excellent" style="height: 70%"></div>
                    <span>5</span>
                </div>
                <div class="chart-item">
                    <div class="chart-bar good" style="height: 20%"></div>
                    <span>4</span>
                </div>
                <div class="chart-item">
                    <div class="chart-bar satisfactory" style="height: 10%"></div>
                    <span>3</span>
                </div>
            </div>
            <div class="chart-legend">
                <div class="legend-item">
                    <span class="legend-color excellent"></span>
                    <span>Отлично (70%)</span>
                </div>
                <div class="legend-item">
                    <span class="legend-color good"></span>
                    <span>Хорошо (20%)</span>
                </div>
                <div class="legend-item">
                    <span class="legend-color satisfactory"></span>
                    <span>Удовлетворительно (10%)</span>
                </div>
            </div>
        </div>

        <!-- Динамика успеваемости -->
        <div class="stats-card">
            <h3><i class="fas fa-trend-up"></i> Динамика успеваемости</h3>
            <div class="trend-chart">
                <div class="trend-line">
                    <div class="trend-point" style="bottom: 40%">4.2</div>
                    <div class="trend-point" style="bottom: 50%">4.5</div>
                    <div class="trend-point" style="bottom: 60%">4.7</div>
                    <div class="trend-point" style="bottom: 70%">4.8</div>
                </div>
            </div>
            <div class="trend-months">
                <span>Сентябрь</span>
                <span>Октябрь</span>
                <span>Ноябрь</span>
                <span>Декабрь</span>
            </div>
        </div>
    </div>
</div>

<style>
.grades-overview {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.overview-card {
    background: white;
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    display: flex;
    align-items: center;
    gap: 20px;
    transition: transform 0.3s ease;
}

.overview-card:hover {
    transform: translateY(-5px);
}

.overview-icon {
    width: 60px;
    height: 60px;
    border-radius: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.5rem;
}

.overview-content h3 {
    font-size: 2rem;
    margin: 0;
    color: var(--dark);
}

.overview-content p {
    margin: 5px 0 0 0;
    color: #6c757d;
}

.grades-content {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 25px;
}

.grades-section {
    background: white;
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
}

.grades-section h3 {
    color: var(--primary);
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 2px solid #f0f0f0;
    display: flex;
    align-items: center;
    gap: 10px;
}

.subject-grades {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.subject-card {
    border: 1px solid #e9ecef;
    border-radius: 10px;
    overflow: hidden;
}

.subject-header {
    background: #f8f9fa;
    padding: 15px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #e9ecef;
}

.subject-header h4 {
    margin: 0;
    color: var(--dark);
}

.subject-avg {
    background: var(--primary);
    color: white;
    padding: 5px 12px;
    border-radius: 15px;
    font-weight: bold;
}

.grades-list {
    padding: 15px 20px;
}

.grade-item {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr;
    gap: 15px;
    padding: 12px 0;
    border-bottom: 1px solid #f8f9fa;
    align-items: center;
}

.grade-item:last-child {
    border-bottom: none;
}

.grade-work {
    font-weight: 500;
}

.grade-value {
    padding: 4px 12px;
    border-radius: 15px;
    font-weight: bold;
    text-align: center;
    font-size: 0.9rem;
}

.grade-value.excellent {
    background: #d4edda;
    color: #155724;
}

.grade-value.good {
    background: #fff3cd;
    color: #856404;
}

.grade-value.pending {
    background: #e2e3e5;
    color: #6c757d;
}

.grade-date {
    color: #6c757d;
    font-size: 0.9rem;
    text-align: right;
}

.stats-section {
    display: flex;
    flex-direction: column;
    gap: 25px;
}

.stats-card {
    background: white;
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
}

.stats-card h3 {
    color: var(--primary);
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.chart-container {
    display: flex;
    justify-content: space-around;
    align-items: end;
    height: 150px;
    margin-bottom: 20px;
    border-bottom: 2px solid #e9ecef;
    padding-bottom: 20px;
}

.chart-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
}

.chart-bar {
    width: 30px;
    border-radius: 5px 5px 0 0;
    transition: height 0.3s ease;
}

.chart-bar.excellent {
    background: #28a745;
}

.chart-bar.good {
    background: #ffc107;
}

.chart-bar.satisfactory {
    background: #fd7e14;
}

.chart-legend {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.9rem;
}

.legend-color {
    width: 15px;
    height: 15px;
    border-radius: 3px;
}

.legend-color.excellent {
    background: #28a745;
}

.legend-color.good {
    background: #ffc107;
}

.legend-color.satisfactory {
    background: #fd7e14;
}

.trend-chart {
    height: 120px;
    position: relative;
    margin-bottom: 30px;
    border-bottom: 2px solid #e9ecef;
}

.trend-line {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 100%;
    background: linear-gradient(to top, #4361ee33, #4361ee00);
    border-radius: 5px;
}

.trend-point {
    position: absolute;
    width: 12px;
    height: 12px;
    background: var(--primary);
    border-radius: 50%;
    transform: translateX(-50%);
    font-size: 0.7rem;
    text-align: center;
    line-height: 12px;
    color: white;
}

.trend-point:nth-child(1) { left: 12%; }
.trend-point:nth-child(2) { left: 37%; }
.trend-point:nth-child(3) { left: 62%; }
.trend-point:nth-child(4) { left: 87%; }

.trend-months {
    display: flex;
    justify-content: space-between;
    font-size: 0.8rem;
    color: #6c757d;
}
.page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const gradeItems = document.querySelectorAll('.grade-item');
    gradeItems.forEach((item, index) => {
        item.style.opacity = '0';
        item.style.transform = 'translateX(-20px)';

        setTimeout(() => {
            item.style.transition = 'all 0.5s ease';
            item.style.opacity = '1';
            item.style.transform = 'translateX(0)';
        }, index * 100);
    });

    const chartBars = document.querySelectorAll('.chart-bar');
    chartBars.forEach(bar => {
        const originalHeight = bar.style.height;
        bar.style.height = '0%';

        setTimeout(() => {
            bar.style.transition = 'height 1s ease';
            bar.style.height = originalHeight;
        }, 500);
    });
});
</script>
{% endblock %}